<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="MobileOptimized" content="176" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="robots" content="noindex,nofollow" />
    <script src="https://telegram.org/js/telegram-web-app.js?2"></script>
    <title>FitTracker AI</title>
    <style>
        :root {
            /* –Ø—Ä–∫–∞—è –ø–∞–ª–∏—Ç—Ä–∞ –Ω–µ–æ–±—Ä—É—Ç–∞–ª–∏–∑–º–∞ */
            --neobrut-black: #000000;
            --neobrut-white: #FFFFFF;
            --neobrut-orange: #FF6B35;
            --neobrut-red: #FF006E;
            --neobrut-yellow: #FFBE0B;
            --neobrut-blue: #3A86FF;
            --neobrut-green: #06FFB4;
            --neobrut-purple: #8338EC;
            --neobrut-pink: #FF4081;
            --neobrut-gray: #495057;
            --neobrut-lightgray: #F8F9FA;
            --neobrut-darkgray: #212529;
            --neobrut-cream: #FFFDE7;
            --success-green: #00F5A0;
            --warning-yellow: #FFD23F;
            --bg-grid: #F1F3F5;
            --accent-blue: #4ECDC4;
            --accent-purple: #C77DFF;
            --accent-coral: #FF6B9D;
            /* –ù–æ–≤–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
            --lime-green: #D4ED4A;
            --light-green: #98D98E;
            --medium-green: #3CB371;
            --swamp-green: #2F5233;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--neobrut-lightgray);
            color: var(--neobrut-darkgray);
            min-height: 100vh;
            position: relative;
            scrollbar-width: none;
            -ms-overflow-style: none;
            display: flex;
            flex-direction: column;
            font-size: 16px;
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }

        body::-webkit-scrollbar {
            display: none;
        }

        /* –í–µ—Ä—Ö–Ω—è—è —Å–µ–∫—Ü–∏—è —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ */
        .workout-section {
            background: var(--neobrut-white);
            border-bottom: 4px solid var(--neobrut-black);
            padding: 15px 0;
            position: relative;
            box-shadow: 8px 8px 0 var(--neobrut-black);
            flex-shrink: 0;
        }

        .workout-header {
            padding: 0 20px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .workout-title {
            font-size: 24px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--neobrut-black);
            text-shadow:
                1px 1px 0 rgba(255, 255, 255, 0.1),
                2px 2px 0 rgba(0, 0, 0, 0.05),
                3px 3px 0 rgba(0, 0, 0, 0.05),
                4px 4px 0 rgba(0, 0, 0, 0.05);
            position: relative;
            display: inline-block;
        }

        .workout-counter {
            background: var(--neobrut-yellow);
            border: 3px solid var(--neobrut-black);
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 800;
            box-shadow: 4px 4px 0 var(--neobrut-black);
            border-radius: 8px;
            color: var(--neobrut-black);
            transform: rotate(-2deg);
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π */
        .workout-carousel {
            position: relative;
            overflow: hidden;
            padding: 10px 0;
        }

        .workout-track {
            display: flex;
            gap: 20px;
            padding: 20px 40px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º padding –ø–æ –±–æ–∫–∞–º –¥–ª—è –º–µ—Å—Ç–∞ –ø–æ–¥ –º–∞—Å—à—Ç–∞–± */
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: none;
            -ms-overflow-style: none;
            scroll-snap-type: x mandatory;
        }

        .workout-track::-webkit-scrollbar {
            display: none;
        }

        /* –ë–ª–æ–∫–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ - –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –ø—É—Å—Ç—ã–µ –≤ —Å—Ç–∏–ª–µ –Ω–µ–æ–±—Ä—É—Ç–∞–ª–∏–∑–º–∞ */
        .workout-block {
            flex: 0 0 150px;
            width: 150px;
            height: 150px;
            background: var(--neobrut-white);
            border: 4px solid var(--neobrut-black);
            border-radius: 16px;
            box-shadow:
                8px 8px 0 var(--neobrut-black),
                inset 2px 2px 0 rgba(0,0,0,0.1);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            opacity: 0.8;
            transform: scale(0.95) rotate(-2deg);
            scroll-snap-align: center;
            touch-action: manipulation;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* 3D-—ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –≤–º–µ—Å—Ç–æ scale */
        .workout-block.focused {
            opacity: 1;
            width: 170px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –≤–º–µ—Å—Ç–æ scale */
            height: 170px;
            margin: -10px; /* –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ */
            transform: rotate(0deg) translateY(-2px);
            box-shadow:
                12px 12px 0 var(--neobrut-black),
                inset 2px 2px 0 rgba(0,0,0,0.1);
            z-index: 10;
        }

        .workout-block:hover {
            background: var(--accent-blue);
            box-shadow:
                4px 4px 0 var(--neobrut-black),
                inset 2px 2px 0 rgba(0,0,0,0.1);
        }

        .workout-block.focused:hover {
            background: var(--accent-purple);
            box-shadow:
                4px 4px 0 var(--neobrut-black),
                inset 2px 2px 0 rgba(0,0,0,0.1);
        }

        .workout-number {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-8deg);
            width: 60px;
            height: 60px;
            background: var(--neobrut-orange);
            border: 3px solid var(--neobrut-black);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: 900;
            box-shadow: 4px 4px 0 var(--neobrut-black);
            color: var(--neobrut-white);
            border-radius: 12px;
            z-index: 2;
        }

        .workout-day {
            position: absolute;
            bottom: 20px;
            font-size: 18px;
            font-weight: 900;
            text-transform: uppercase;
            color: var(--neobrut-black);
            letter-spacing: 0.05em;
            text-align: center;
            width: 100%;
        }

        /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø—É—Å—Ç—ã—Ö –±–ª–æ–∫–æ–≤ */
        .workout-block::before {
            content: '';
            position: absolute;
            top: 15px;
            right: 15px;
            width: 20px;
            height: 20px;
            background: var(--neobrut-pink);
            border: 2px solid var(--neobrut-black);
            border-radius: 50%;
            box-shadow: 2px 2px 0 var(--neobrut-black);
            opacity: 0.8;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-overlay.show {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-container {
            background: var(--neobrut-white);
            border: 5px solid var(--neobrut-black);
            border-radius: 20px;
            box-shadow:
                12px 12px 0 var(--neobrut-black),
                0 0 0 2px var(--neobrut-black);
            width: 80%;
            height: 80%;
            max-width: 900px;
            max-height: 700px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: scale(0.9) rotate(-2deg);
            animation: modalAppear 0.3s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes modalAppear {
            to {
                transform: scale(1) rotate(0deg);
            }
        }

        .modal-header {
            background: var(--neobrut-yellow);
            border-bottom: 5px solid var(--neobrut-black);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .modal-header::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 20px;
            width: 60px;
            height: 20px;
            background: var(--neobrut-pink);
            border: 3px solid var(--neobrut-black);
            border-radius: 10px;
            transform: rotate(-5deg);
        }

        .modal-title {
            font-size: 28px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--neobrut-black);
        }

        .modal-close {
            width: 50px;
            height: 50px;
            background: var(--neobrut-red);
            border: 4px solid var(--neobrut-black);
            border-radius: 15px;
            font-size: 32px;
            font-weight: 900;
            color: var(--neobrut-white);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 4px 4px 0 var(--neobrut-black);
            transition: all 0.2s;
            transform: rotate(0deg);
        }

        .modal-close:hover {
            transform: rotate(90deg) scale(1.1);
            background: var(--neobrut-orange);
        }

        .modal-close:active {
            transform: rotate(90deg) scale(0.95) translate(2px, 2px);
            box-shadow: 2px 2px 0 var(--neobrut-black);
        }

        .modal-content {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            background: var(--neobrut-white);
        }

        /* Todo-—Å–ø–∏—Å–æ–∫ –≤ —Å—Ç–∏–ª–µ –Ω–µ–æ–±—Ä—É—Ç–∞–ª–∏–∑–º–∞ */
        .todo-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω—é—é –ø–æ–¥—Å–≤–µ—Ç–∫—É –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        .todo-list * {
            outline: none !important;
        }

        .todo-list *:focus {
            outline: none !important;
            box-shadow: none !important;
        }

        /* –û—Ç–∫–ª—é—á–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ */
        .todo-item,
        .todo-subitem,
        .todo-text,
        .todo-expand,
        .todo-checkbox {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (hover: none) and (pointer: coarse) {
            .todo-item:active,
            .todo-subitem:active,
            .todo-expand:active {
                -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                -khtml-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
            }
        }

        .todo-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            padding: 15px;
            background: var(--neobrut-lightgray);
            border: 3px solid var(--neobrut-black);
            box-shadow: 5px 5px 0 var(--neobrut-black);
            border-radius: 12px;
            transition: all 0.2s;
        }

        .todo-item:hover {
            transform: translate(-2px, -2px);
            box-shadow: 7px 7px 0 var(--neobrut-black);
        }

        .todo-item.completed {
            opacity: 0.7;
            background: var(--success-green);
        }

        .todo-checkbox {
            position: relative;
            width: 24px;
            height: 24px;
            margin-right: 15px;
            margin-top: 2px;
            flex-shrink: 0;
            cursor: pointer;
        }

        .todo-checkbox input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            z-index: 2;
            outline: none; /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω—é—é —Ä–∞–º–∫—É –ø—Ä–∏ –∫–ª–∏–∫–µ */
        }

        .checkbox-visual {
            position: absolute;
            top: 0;
            left: 0;
            width: 24px;
            height: 24px;
            background: var(--neobrut-white);
            border: 3px solid var(--neobrut-black);
            border-radius: 6px;
            transition: all 0.2s;
        }

        .todo-checkbox input:checked ~ .checkbox-visual {
            background: var(--neobrut-yellow);
            transform: rotate(-5deg);
        }

        .checkbox-checkmark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 14px;
            height: 10px;
            border-left: 3px solid var(--neobrut-black);
            border-bottom: 3px solid var(--neobrut-black);
            transition: transform 0.2s;
        }

        .todo-checkbox input:checked ~ .checkbox-checkmark {
            transform: translate(-50%, -50%) rotate(-45deg) scale(1);
        }

        .todo-text {
            flex: 1;
            font-size: 18px;
            font-weight: 600;
            color: var(--neobrut-darkgray);
            user-select: none;
            cursor: pointer;
            outline: none; /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω—é—é —Ä–∞–º–∫—É –ø—Ä–∏ –∫–ª–∏–∫–µ */
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
            opacity: 0.8;
        }

        /* –ü–æ–¥–ø—É–Ω–∫—Ç—ã */
        .todo-sublist {
            list-style: none;
            padding: 0;
            margin: 10px 0 0 0;
            display: none; /* –°–∫—Ä—ã—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }

        .todo-sublist.expanded {
            display: block;
        }

        .todo-subitem {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
            padding: 10px;
            background: var(--neobrut-white);
            border: 2px solid var(--neobrut-gray);
            box-shadow: 3px 3px 0 var(--neobrut-black);
            border-radius: 8px;
            font-size: 14px;
        }

        .todo-subitem:hover {
            transform: translate(-1px, -1px);
            box-shadow: 4px 4px 0 var(--neobrut-black);
        }

        .todo-subitem .todo-checkbox {
            width: 18px;
            height: 18px;
            margin-right: 10px;
            margin-top: 1px;
        }

        .todo-subitem .checkbox-visual {
            width: 18px;
            height: 18px;
            border-radius: 4px;
        }

        .todo-subitem .checkbox-checkmark {
            width: 10px;
            height: 8px;
            border-width: 2px;
        }

        .todo-subitem .todo-text {
            font-size: 14px;
            font-weight: 500;
            outline: none; /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω—é—é —Ä–∞–º–∫—É –ø—Ä–∏ –∫–ª–∏–∫–µ */
        }

        .todo-subitem.completed {
            opacity: 0.7;
            background: var(--success-green) !important;
        }

        .todo-subitem.completed .todo-text {
            text-decoration: line-through;
            opacity: 0.8;
        }

        /* –ú–∞—Ä–∫–µ—Ä –¥–ª—è –ø–æ–¥–ø—É–Ω–∫—Ç–æ–≤ */
        .todo-bullet {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--neobrut-gray);
            border-radius: 50%;
            margin-right: 8px;
            flex-shrink: 0;
            margin-top: 6px;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è */
        .todo-expand {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            margin-left: 10px;
            background: var(--neobrut-yellow);
            border: 3px solid var(--neobrut-black);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            flex-shrink: 0;
            box-shadow: 3px 3px 0 var(--neobrut-black);
        }

        .todo-expand:hover {
            transform: scale(1.05);
            box-shadow: 4px 4px 0 var(--neobrut-black);
        }

        .todo-expand:active {
            transform: scale(0.95) rotate(180deg);
        }

        .todo-expand svg {
            width: 16px;
            height: 16px;
            transition: transform 0.3s ease;
        }

        .todo-expand.expanded svg {
            transform: rotate(180deg);
        }

        /* –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Ç–µ–∫—Å—Ç–∞ —Å –∫–Ω–æ–ø–∫–æ–π */
        .todo-text-wrapper {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

        /* –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–¥–∞–Ω–∏–π */
        .no-tasks {
            text-align: center;
            padding: 60px 20px;
            font-size: 20px;
            font-weight: 700;
            color: var(--neobrut-gray);
            background: var(--neobrut-lightgray);
            border: 3px dashed var(--neobrut-gray);
            border-radius: 12px;
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
        @media (max-width: 768px) {
            .modal-container {
                width: 95%;
                height: 90%;
                border-width: 3px;
            }

            .modal-title {
                font-size: 20px;
            }

            .modal-close {
                width: 40px;
                height: 40px;
                font-size: 24px;
            }

            .modal-content {
                padding: 20px;
            }
        }

        /* –ù–∏–∂–Ω—è—è —Å–µ–∫—Ü–∏—è —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é */
        .activity-section {
            padding: 15px;
            background: var(--neobrut-white);
            display: flex;
            flex-direction: column;
            flex: 1;
            box-shadow: 0 -4px 0 var(--neobrut-black);
            min-height: 0;
        }

        .activity-header {
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .activity-title {
            font-size: 20px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--neobrut-black);
            text-shadow:
                1px 1px 0 rgba(255, 255, 255, 0.1),
                2px 2px 0 rgba(0, 0, 0, 0.05),
                3px 3px 0 rgba(0, 0, 0, 0.05),
                4px 4px 0 rgba(0, 0, 0, 0.05);
            position: relative;
            display: inline-block;
        }

        .activity-legend {
            display: flex;
            gap: 10px;
            font-size: 8px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .legend-color {
            width: 10px;
            height: 10px;
            border: 1px solid var(--neobrut-black);
        }

        /* –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
        .activity-grid-vertical {
            background: var(--neobrut-white);
            border: 4px solid var(--neobrut-black);
            border-radius: 12px;
            padding: 15px;
            box-shadow: 6px 6px 0 var(--neobrut-black);
            margin-top: 15px;
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 400px;
            max-height: calc(100vh - 450px);
        }

        .calendar-container {
            width: 100%;
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            scrollbar-width: thin;
            scrollbar-color: var(--neobrut-gray) transparent;
        }

        .calendar-container::-webkit-scrollbar {
            width: 8px;
        }

        .calendar-container::-webkit-scrollbar-track {
            background: var(--neobrut-lightgray);
            border-radius: 4px;
        }

        .calendar-container::-webkit-scrollbar-thumb {
            background: var(--neobrut-gray);
            border-radius: 4px;
            border: 2px solid var(--neobrut-black);
        }

        .calendar-month {
            margin-bottom: 20px;
        }

        .calendar-month-header {
            font-size: 16px;
            font-weight: 800;
            text-transform: uppercase;
            margin-bottom: 10px;
            color: var(--neobrut-black);
            background: var(--neobrut-yellow);
            border: 3px solid var(--neobrut-black);
            padding: 8px 16px;
            border-radius: 8px;
            box-shadow: 3px 3px 0 var(--neobrut-black);
            display: inline-block;
            transform: rotate(-1deg);
        }

        .calendar-week {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }

        .calendar-weekday {
            font-size: 11px;
            font-weight: 700;
            color: var(--neobrut-gray);
            width: 32px;
            text-align: center;
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .activity-cell {
            width: 32px;
            height: 32px;
            border: 3px solid var(--neobrut-black);
            border-radius: 8px;
            cursor: default;
            transition: all 0.2s;
            position: relative;
            touch-action: manipulation;
        }

        /* –£–¥–∞–ª–µ–Ω—ã hover-—ç—Ñ—Ñ–µ–∫—Ç—ã - —è—á–µ–π–∫–∏ –±–æ–ª—å—à–µ –Ω–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã */
        /* .activity-cell:hover {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 5px 5px 0 var(--neobrut-black);
        } */

        /* –£–¥–∞–ª–µ–Ω active-—ç—Ñ—Ñ–µ–∫—Ç - —è—á–µ–π–∫–∏ –±–æ–ª—å—à–µ –Ω–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã */
        /* .activity-cell:active {
            transform: translateY(0) scale(0.95);
            box-shadow: 2px 2px 0 var(--neobrut-black);
        } */

        .activity-cell.empty {
            background: transparent;
            border-color: transparent;
            cursor: default;
        }

        .activity-cell.empty:hover {
            transform: none;
            box-shadow: none;
        }

        /* –£—Ä–æ–≤–Ω–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ - –ó–µ–ª–µ–Ω–∞—è –≥—Ä–∞–¥–∞—Ü–∏—è */
        .activity-cell[data-activity="0"] {
            background: var(--neobrut-lightgray);
        }

        .activity-cell[data-activity="30"] {
            background: var(--lime-green);
        }

        .activity-cell[data-activity="60"] {
            background: var(--light-green);
        }

        .activity-cell[data-activity="90"] {
            background: var(--medium-green);
        }

        .activity-cell[data-activity="120"] {
            background: var(--swamp-green);
        }

        .activity-cell.today {
            outline: 4px solid var(--neobrut-orange);
            outline-offset: 2px;
        }

        .activity-cell .date-number {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 11px;
            font-weight: 700;
            color: var(--neobrut-black);
            opacity: 0.7;
        }

        /* –õ–µ–≥–µ–Ω–¥–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è */
        .contrib-legend-vertical {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            gap: 8px;
            font-size: 12px;
            font-weight: 700;
            color: var(--neobrut-black);
            background: var(--neobrut-lightgray);
            border: 3px solid var(--neobrut-black);
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 3px 3px 0 var(--neobrut-black);
            flex-shrink: 0;
        }

        .year-selector {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .year-btn {
            background: var(--neobrut-yellow);
            border: 3px solid var(--neobrut-black);
            padding: 10px 16px;
            font-weight: 800;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 8px;
            color: var(--neobrut-black);
            box-shadow: 3px 3px 0 var(--neobrut-black);
            touch-action: manipulation;
            min-width: 50px;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .year-btn:active {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0 var(--neobrut-black);
        }

        .reset-btn {
            background: var(--neobrut-red);
            border: 3px solid var(--neobrut-black);
            padding: 10px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 8px;
            color: var(--neobrut-white);
            box-shadow: 3px 3px 0 var(--neobrut-black);
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 44px;
            height: 44px;
        }

        .reset-btn:hover {
            transform: translateY(-3px);
            box-shadow: 6px 6px 0 var(--neobrut-black);
            background: #FF0040;
        }

        .reset-btn:active {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0 var(--neobrut-black);
        }

        .year-nav {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .current-year {
            font-size: 18px;
            font-weight: 900;
            text-transform: uppercase;
            color: var(--neobrut-black);
            background: var(--neobrut-blue);
            padding: 8px 16px;
            border: 3px solid var(--neobrut-black);
            box-shadow: 3px 3px 0 var(--neobrut-black);
            border-radius: 8px;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è GitHub-—Å—Ç–∏–ª—å —Ç–∞–±–ª–∏—Ü—ã */
        .contribution-graph {
            font-size: 10px;
            color: #57606a;
            position: relative;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è SVG —ç–ª–µ–º–µ–Ω—Ç–æ–≤ - GitHub —Å—Ç–∏–ª—å */
        .contribution-calendar {
            width: 100%;
            overflow-x: auto;
            overflow-y: hidden;
        }

        .calendar-graph {
            padding: 5px 0 0;
            text-align: center;
        }

        .calendar-graph svg {
            font-family: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        /* –ú–µ—Å—è—Ü—ã */
        .month-label {
            font-size: 10px;
            fill: var(--neobrut-gray);
            font-weight: 600;
        }

        /* –î–Ω–∏ –Ω–µ–¥–µ–ª–∏ */
        .day-label {
            font-size: 9px;
            fill: var(--neobrut-gray);
            font-weight: 500;
            text-anchor: start;
        }

        /* –Ø—á–µ–π–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
        .contribution-day {
            shape-rendering: geometricPrecision;
            stroke: rgba(27, 31, 35, 0.04);
            stroke-width: 1px;
            rx: 2;
            ry: 2;
        }

        .contribution-day:hover {
            stroke: rgba(255, 255, 255, 0.4);
            stroke-width: 2px;
        }

        /* –£—Ä–æ–≤–Ω–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ - –Ø—Ä–∫–∏–µ —Ü–≤–µ—Ç–∞ –Ω–µ–æ–±—Ä—É—Ç–∞–ª–∏–∑–º–∞ */
        .contribution-day[data-level="0"] {
            fill: var(--neobrut-lightgray);
            stroke: var(--neobrut-gray);
        }

        .contribution-day[data-level="1"] {
            fill: var(--warning-yellow);
            stroke: var(--neobrut-black);
        }

        .contribution-day[data-level="2"] {
            fill: var(--neobrut-orange);
            stroke: var(--neobrut-black);
        }

        .contribution-day[data-level="3"] {
            fill: var(--neobrut-pink);
            stroke: var(--neobrut-black);
        }

        .contribution-day[data-level="4"] {
            fill: var(--accent-purple);
            stroke: var(--neobrut-black);
        }

        /* –°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å */
        .contribution-day.today {
            stroke: var(--neobrut-orange);
            stroke-width: 2px;
        }

        /* Tooltip */
        .tip {
            position: absolute;
            z-index: 100;
            font-size: 11px;
            line-height: 1.4;
            font-weight: 400;
            background: var(--neobrut-darkgray);
            color: var(--neobrut-white);
            padding: 5px 8px;
            border-radius: 3px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            white-space: nowrap;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .tip.show {
            opacity: 1;
        }

        /* –õ–µ–≥–µ–Ω–¥–∞ */
        .contrib-legend {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-top: 10px;
            gap: 3px;
            font-size: 9px;
            color: var(--neobrut-gray);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 2px;
        }

        .legend-color {
            width: 9px;
            height: 9px;
            rx: 2;
            ry: 2;
        }

        
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-summary {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-card {
            background: var(--neobrut-white);
            border: 3px solid var(--neobrut-black);
            padding: 15px;
            text-align: center;
            box-shadow: 6px 6px 0 var(--neobrut-black);
            transition: all 0.3s;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
        }

        .stat-card:nth-child(1) {
            background: var(--neobrut-yellow);
            transform: rotate(-1deg);
        }

        .stat-card:nth-child(2) {
            background: var(--neobrut-blue);
            transform: rotate(1deg);
        }

        .stat-card:nth-child(3) {
            background: var(--neobrut-pink);
            transform: rotate(-2deg);
        }

        .stat-card:nth-child(4) {
            background: var(--accent-purple);
            transform: rotate(2deg);
        }

        .stat-card:active {
            transform: rotate(0deg) scale(0.95);
            box-shadow: 2px 2px 0 var(--neobrut-black);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 900;
            color: var(--neobrut-black);
            margin-bottom: 8px;
            text-shadow: 2px 2px 0 rgba(255,255,255,0.3);
        }

        .stat-label {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--neobrut-black);
            background: rgba(255,255,255,0.4);
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-width: 390px) {
            .workout-title {
                font-size: 20px;
            }

            .activity-title {
                font-size: 18px;
            }

            .workout-block {
                flex: 0 0 130px;
                width: 130px;
                height: 130px;
            }

            .stat-value {
                font-size: 28px;
            }

            .stats-summary {
                gap: 10px;
            }
        }

        /* –û—Ç–∫–ª—é—á–∞–µ–º hover-—ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø—Ä–∏ —Å–≤–∞–π–ø–µ */
        @media (hover: none) and (pointer: coarse) {
            .workout-block:hover {
                background: var(--neobrut-white);
                box-shadow:
                    6px 6px 0 var(--neobrut-black),
                    inset 2px 2px 0 rgba(0,0,0,0.1);
            }

            .workout-block.focused:hover {
                background: var(--neobrut-white);
                box-shadow:
                    8px 8px 0 var(--neobrut-black),
                    inset 2px 2px 0 rgba(0,0,0,0.1);
            }
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .workout-section,
        .activity-section {
            animation: slideIn 0.5s ease-out;
        }

        .activity-section {
            animation-delay: 0.1s;
        }

        /* Tooltip –¥–ª—è –¥–Ω—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
        .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--neobrut-darkgray);
            color: var(--neobrut-white);
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(45, 52, 54, 0.2);
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 4px solid transparent;
            border-top-color: var(--neobrut-darkgray);
        }

        .day-cell:hover .tooltip {
            opacity: 1;
        }
    </style>
</head>

<body>
    <!-- –í–µ—Ä—Ö–Ω—è—è —Å–µ–∫—Ü–∏—è —Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º–∏ -->
    <div class="workout-section">
        <div class="workout-header">
            <h1 class="workout-title">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è –ü—Ä–æ–≥—Ä–∞–º–º–∞</h1>
            <div class="workout-counter">
                <span id="completed-count">0</span> / 7
            </div>
        </div>

        <div class="workout-carousel">
            <div class="workout-track" id="workout-track">
                <!-- –ë–ª–æ–∫–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã JavaScript -->
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è —Å–µ–∫—Ü–∏—è —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é -->
    <div class="activity-section">
        <div class="activity-header">
            <h2 class="activity-title">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h2>
            <div class="year-nav">
                <button class="year-btn" id="prev-year">‚Üê</button>
                <span class="current-year" id="current-year">2024</span>
                <button class="year-btn" id="next-year">‚Üí</button>
                <button class="reset-btn" id="reset-activity" title="–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å">üîÑ</button>
            </div>
        </div>

        <!-- –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
        <div class="activity-grid-vertical">
            <div class="calendar-container">
                <div class="calendar-months" id="calendar-months">
                    <!-- –ú–µ—Å—è—Ü—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è JavaScript -->
                </div>
            </div>

            <!-- –õ–µ–≥–µ–Ω–¥–∞ -->
            <div class="contrib-legend-vertical">
                <span>–ú–µ–Ω—å—à–µ</span>
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--neobrut-lightgray);"></div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--lime-green);"></div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--light-green);"></div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--medium-green);"></div>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--swamp-green);"></div>
                </div>
                <span>–ë–æ–ª—å—à–µ</span>
            </div>

            <!-- Tooltip –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
            <div class="tip" id="activity-tooltip"></div>
        </div>

        <div class="stats-summary">
            <div class="stat-card">
                <div class="stat-value" id="total-days">0</div>
                <div class="stat-label">–î–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="current-streak">0</div>
                <div class="stat-label">–¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="longest-streak">0</div>
                <div class="stat-label">–î–ª–∏–Ω–Ω–µ–π—à–∞—è —Å–µ—Ä–∏—è</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="total-workouts">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <div class="modal-overlay" id="workout-modal">
        <div class="modal-container">
            <div class="modal-header">
                <div class="modal-title" id="modal-title">–î–µ–Ω—å 1 - –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</div>
                <button class="modal-close" id="modal-close">√ó</button>
            </div>
            <div class="modal-content" id="modal-content">
                <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç -->
            </div>
        </div>
    </div>

    <script>
        // –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
        const workoutProgram = [
            { day: 1, name: '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', exercises: ['–û—Ç–∂–∏–º–∞–Ω–∏—è', '–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è', '–ü–ª–∞–Ω–∫–∞'] },
            { day: 2, name: '–í—Ç–æ—Ä–Ω–∏–∫', exercises: ['–ü—Ä—ã–∂–∫–∏ "–î–∂–µ–∫"', '–í—ã–ø–∞–¥—ã', '–ü–ª–∞–Ω–∫–∞'] },
            { day: 3, name: '–°—Ä–µ–¥–∞', exercises: ['–û—Ç–∂–∏–º–∞–Ω–∏—è', '–ë–µ—Ä–ø–∏', '–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è'] },
            { day: 4, name: '–ß–µ—Ç–≤–µ—Ä–≥', exercises: ['–ü–ª–∞–Ω–∫–∞', '–í—ã–ø–∞–¥—ã', '–ü—Ä—ã–∂–∫–∏ "–î–∂–µ–∫"'] },
            { day: 5, name: '–ü—è—Ç–Ω–∏—Ü–∞', exercises: ['–û—Ç–∂–∏–º–∞–Ω–∏—è', '–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è', '–ë–µ—Ä–ø–∏'] },
            { day: 6, name: '–°—É–±–±–æ—Ç–∞', exercises: ['–ü—Ä—ã–∂–∫–∏ "–î–∂–µ–∫"', '–í—ã–ø–∞–¥—ã', '–ü–ª–∞–Ω–∫–∞'] },
            { day: 7, name: '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', exercises: ['–û—Ç–∂–∏–º–∞–Ω–∏—è', '–ë–µ—Ä–ø–∏', '–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è'] }
        ];

        // –ò–∫–æ–Ω–∫–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
        const exerciseIcons = {
            '–û—Ç–∂–∏–º–∞–Ω–∏—è': 'üí™',
            '–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è': 'ü¶µ',
            '–ü–ª–∞–Ω–∫–∞': 'üßò',
            '–ü—Ä—ã–∂–∫–∏ "–î–∂–µ–∫"': '‚ö°',
            '–í—ã–ø–∞–¥—ã': 'üèÉ',
            '–ë–µ—Ä–ø–∏': 'üî•'
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let currentYear = new Date().getFullYear();
        let currentMonth = new Date().getMonth(); // 0 = –Ø–Ω–≤–∞—Ä—å, 11 = –î–µ–∫–∞–±—Ä—å
        let activityData = {};
        let selectedWorkout = 1;
        let todoData = {}; // –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è todo-—Å–ø–∏—Å–∫–æ–≤

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è todo-—Å–ø–∏—Å–∫–æ–≤
        function initializeTodoLists() {
            todoData = {
                1: [
                    {
                        id: 'task-1',
                        text: '–ø–æ–∫—É—à–∞—Ç—å',
                        completed: false,
                        subtasks: []
                    },
                    {
                        id: 'task-2',
                        text: '–ø—Ä–æ–±–µ–∂–∫–∞',
                        completed: false,
                        subtasks: [
                            {
                                id: 'task-2-sub1',
                                text: '2–∫–º',
                                completed: false
                            },
                            {
                                id: 'task-2-sub2',
                                text: '3–∫–º',
                                completed: false
                            }
                        ]
                    },
                    {
                        id: 'task-3',
                        text: '—Å–ø–∞—Ç—å',
                        completed: false,
                        subtasks: []
                    }
                ],
                2: [
                    {
                        id: 'task-4',
                        text: '–£—Ç—Ä–µ–Ω–Ω—è—è –∑–∞—Ä—è–¥–∫–∞',
                        completed: false,
                        subtasks: []
                    },
                    {
                        id: 'task-5',
                        text: '–ü—Ä–µ—Å—Å',
                        completed: false,
                        subtasks: []
                    }
                ],
                3: [
                    {
                        id: 'task-6',
                        text: '–†–∞—Å—Ç—è–∂–∫–∞',
                        completed: false,
                        subtasks: []
                    },
                    {
                        id: 'task-7',
                        text: '–û—Ç–∂–∏–º–∞–Ω–∏—è',
                        completed: false,
                        subtasks: []
                    }
                ],
                4: [
                    {
                        id: 'task-8',
                        text: '–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è',
                        completed: false,
                        subtasks: []
                    },
                    {
                        id: 'task-9',
                        text: '–ü–ª–∞–Ω–∫–∞',
                        completed: false,
                        subtasks: []
                    }
                ],
                5: [
                    {
                        id: 'task-10',
                        text: '–ë–µ–≥',
                        completed: false,
                        subtasks: []
                    },
                    {
                        id: 'task-11',
                        text: '–ì–∏–≥–∏–µ–Ω–∏—á–µ—Å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã',
                        completed: false,
                        subtasks: []
                    }
                ],
                6: [
                    {
                        id: 'task-12',
                        text: '–ô–æ–≥–∞',
                        completed: false,
                        subtasks: []
                    },
                    {
                        id: 'task-13',
                        text: '–ú–µ–¥–∏—Ç–∞—Ü–∏—è',
                        completed: false,
                        subtasks: []
                    }
                ],
                7: [
                    {
                        id: 'task-14',
                        text: '–ü—Ä–æ–≥—É–ª–∫–∞',
                        completed: false,
                        subtasks: []
                    },
                    {
                        id: 'task-15',
                        text: '–ß—Ç–µ–Ω–∏–µ',
                        completed: false,
                        subtasks: []
                    }
                ]
            };

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ localStorage
            loadTodoStates();
        }

        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π todo –∏–∑ localStorage
        function loadTodoStates() {
            const saved = localStorage.getItem('fitTrackerTodos');
            if (saved) {
                try {
                    const states = JSON.parse(saved);
                    Object.keys(states).forEach(day => {
                        if (todoData[day]) {
                            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                            todoData[day].forEach(task => {
                                const taskState = states[day][task.id];
                                if (taskState) {
                                    task.completed = taskState.completed;
                                    if (taskState.subtasks) {
                                        task.subtasks.forEach(subtask => {
                                            if (taskState.subtasks[subtask.id] !== undefined) {
                                                subtask.completed = taskState.subtasks[subtask.id];
                                            }
                                        });
                                    }
                                }
                            });
                        }
                    });
                    console.log('–°–æ—Å—Ç–æ—è–Ω–∏—è todo –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ localStorage');
                } catch (e) {
                    console.error('Error loading todo states:', e);
                }
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π todo –≤ localStorage
        function saveTodoStates() {
            const states = {};
            Object.keys(todoData).forEach(day => {
                if (todoData[day]) {
                    states[day] = {};
                    todoData[day].forEach(task => {
                        states[day][task.id] = {
                            completed: task.completed,
                            subtasks: {}
                        };
                        task.subtasks.forEach(subtask => {
                            states[day][task.id].subtasks[subtask.id] = subtask.completed;
                        });
                    });
                }
            });
            localStorage.setItem('fitTrackerTodos', JSON.stringify(states));
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ HTML –¥–ª—è todo-—Å–ø–∏—Å–∫–∞
        function createTodoHtml(todos) {
            if (!todos || todos.length === 0) {
                return '<div class="no-tasks">–ó–∞–¥–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
            }

            let html = '<ul class="todo-list">';

            todos.forEach(task => {
                const taskCompletedClass = task.completed ? 'completed' : '';
                const hasSubtasks = task.subtasks && task.subtasks.length > 0;

                html += `
                    <li class="todo-item ${taskCompletedClass}">
                        <div class="todo-checkbox">
                            <input type="checkbox"
                                   id="${task.id}"
                                   data-task-id="${task.id}"
                                   ${task.completed ? 'checked' : ''}
                                   onchange="toggleTask('${task.id}')">
                            <div class="checkbox-visual"></div>
                            <div class="checkbox-checkmark"></div>
                        </div>
                        <div class="todo-text-wrapper">
                            <div class="todo-text" onclick="toggleTask('${task.id}')">${task.text}</div>
                            ${hasSubtasks ? `
                                <div class="todo-expand" onclick="toggleSublist('${task.id}')" id="expand-${task.id}">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                        <path d="M6 9l6 6 6-6"/>
                                    </svg>
                                </div>
                            ` : ''}
                        </div>
                    </li>
                `;

                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–ø—É–Ω–∫—Ç—ã –µ—Å–ª–∏ –µ—Å—Ç—å
                if (hasSubtasks) {
                    html += `<ul class="todo-sublist" id="sublist-${task.id}">`;
                    task.subtasks.forEach(subtask => {
                        const subtaskCompletedClass = subtask.completed ? 'completed' : '';
                        html += `
                            <li class="todo-subitem ${subtaskCompletedClass}">
                                <div class="todo-checkbox">
                                    <input type="checkbox"
                                           id="${subtask.id}"
                                           data-task-id="${subtask.id}"
                                           ${subtask.completed ? 'checked' : ''}
                                           onchange="toggleTask('${subtask.id}')">
                                    <div class="checkbox-visual"></div>
                                    <div class="checkbox-checkmark"></div>
                                </div>
                                <div class="todo-text" onclick="toggleTask('${subtask.id}')">${subtask.text}</div>
                            </li>
                        `;
                    });
                    html += '</ul>';
                }
            });

            html += '</ul>';
            return html;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞—Ç—ã –¥–ª—è –¥–Ω—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function getWorkoutDate(workoutDay) {
            const today = new Date();

            // –î–µ–Ω—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å–º–µ—â–µ–Ω–∏–µ –æ—Ç —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è
            // –î–µ–Ω—å 1 = —Å–µ–≥–æ–¥–Ω—è, –î–µ–Ω—å 2 = –∑–∞–≤—Ç—Ä–∞, –î–µ–Ω—å 3 = –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞ –∏ —Ç.–¥.
            const dayOffset = workoutDay - 1;

            // –°–æ–∑–¥–∞–µ–º –¥–∞—Ç—É –¥–ª—è –¥–Ω—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            const workoutDate = new Date(today);
            workoutDate.setDate(today.getDate() + dayOffset);

            console.log(`–î–µ–Ω—å ${workoutDay} -> ${workoutDate.toLocaleDateString('ru-RU')} (—Å–º–µ—â–µ–Ω–∏–µ: ${dayOffset} –¥–Ω–µ–π)`);

            return workoutDate;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∑–∞–ø–∏—Å—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        function checkAndRecordActivity() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ todo –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–Ω—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            if (todoData[selectedWorkout]) {
                // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –¥–∞—Ç—É –¥–ª—è –¥–Ω—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
                const workoutDate = getWorkoutDate(selectedWorkout);

                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–Ω—è
                const percentage = calculateCompletionPercentage(selectedWorkout);
                console.log(`–î–µ–Ω—å ${selectedWorkout}: –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è = ${percentage}%`);

                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω—É—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞
                let activityMinutes = 0;
                if (percentage >= 100) {
                    activityMinutes = 120;
                } else if (percentage >= 75) {
                    activityMinutes = 90;
                } else if (percentage >= 50) {
                    activityMinutes = 60;
                } else if (percentage >= 25) {
                    activityMinutes = 30;
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∞—Ç—ã
                const dateKey = formatDateKey(workoutDate);
                const oldActivity = activityData[dateKey] || 0;

                console.log(`–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ ${workoutDate.toLocaleDateString('ru-RU')}: ${oldActivity} -> ${activityMinutes} –º–∏–Ω—É—Ç`);

                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
                if (oldActivity !== activityMinutes) {
                    activityData[dateKey] = activityMinutes;
                    saveActivityData();

                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –µ—Å–ª–∏ –æ–Ω–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≥–æ–¥ –¥–∞—Ç—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
                    if (currentYear === workoutDate.getFullYear()) {
                        renderActivityGrid();
                        updateStats();

                        // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
                        if (activityMinutes > oldActivity && activityMinutes > 0) {
                            const targetCell = document.querySelector(`[data-date="${dateKey}"]`);
                            if (targetCell) {
                                // –°–Ω–∞—á–∞–ª–∞ –æ–±–Ω–æ–≤–ª—è–µ–º data-activity –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞
                                targetCell.dataset.activity = activityMinutes;
                                // –ó–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
                                targetCell.style.transform = 'translateY(-10px) scale(1.2) rotate(5deg)';

                                setTimeout(() => {
                                    targetCell.style.transform = '';
                                }, 300);
                            }
                        }
                    }
                }
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–¥–∞—á–∏
        function toggleTask(taskId) {
            let isSubtask = false;

            // –ò—â–µ–º –∑–∞–¥–∞—á—É –ø–æ ID
            Object.keys(todoData).forEach(day => {
                if (todoData[day]) {
                    todoData[day].forEach(task => {
                        if (task.id === taskId) {
                            // –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞
                            task.completed = !task.completed;

                            // –ï—Å–ª–∏ —É –∑–∞–¥–∞—á–∏ –µ—Å—Ç—å –ø–æ–¥–∑–∞–¥–∞—á–∏, –æ–±–Ω–æ–≤–ª—è–µ–º –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                            if (task.subtasks && task.subtasks.length > 0) {
                                task.subtasks.forEach(subtask => {
                                    subtask.completed = task.completed;
                                    const subCheckbox = document.getElementById(subtask.id);
                                    if (subCheckbox) {
                                        subCheckbox.checked = task.completed;
                                        const subItem = subCheckbox.closest('.todo-subitem');
                                        if (subItem) {
                                            subItem.classList.toggle('completed', task.completed);
                                        }
                                    }
                                });
                                console.log(`–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞ "${task.text}" –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∞, –≤—Å–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã`);
                            }

                            const checkbox = document.getElementById(taskId);
                            if (checkbox) {
                                checkbox.checked = task.completed;
                            }
                            const todoItem = checkbox.closest('.todo-item');
                            if (todoItem) {
                                todoItem.classList.toggle('completed', task.completed);
                            }
                        } else if (task.subtasks) {
                            task.subtasks.forEach(subtask => {
                                if (subtask.id === taskId) {
                                    // –≠—Ç–æ –ø–æ–¥–∑–∞–¥–∞—á–∞
                                    isSubtask = true;
                                    subtask.completed = !subtask.completed;
                                    const checkbox = document.getElementById(taskId);
                                    if (checkbox) {
                                        checkbox.checked = subtask.completed;
                                    }
                                    const todoSubitem = checkbox.closest('.todo-subitem');
                                    if (todoSubitem) {
                                        todoSubitem.classList.toggle('completed', subtask.completed);
                                    }
                                }
                            });
                        }
                    });
                }
            });

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ –±—ã–ª–∞ –æ—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ –∏–ª–∏ –∑–∞–¥–∞—á–∞ –±–µ–∑ –ø–æ–¥–∑–∞–¥–∞—á
            if (!isSubtask) {
                saveTodoStates();
            }

            // –ï—Å–ª–∏ —ç—Ç–æ –±—ã–ª–∞ –ø–æ–¥–∑–∞–¥–∞—á–∞, –æ–±–Ω–æ–≤–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –∑–∞–¥–∞—á—É
            if (isSubtask) {
                updateParentTaskCompletion(taskId);
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
            checkAndRecordActivity();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–æ–¥–ø—É–Ω–∫—Ç–æ–≤
        function toggleSublist(taskId) {
            const sublist = document.getElementById(`sublist-${taskId}`);
            const expandBtn = document.getElementById(`expand-${taskId}`);

            if (sublist && expandBtn) {
                sublist.classList.toggle('expanded');
                expandBtn.classList.toggle('expanded');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
            }
            initializeApp();
        });

        function initializeApp() {
            loadActivityData();
            initializeTodoLists();
            // –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø—Ä–æ–≤–µ—Ä—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –∑–∞–¥–∞—á–∏
            updateAllParentTasks();
            renderWorkoutBlocks();
            renderActivityGrid();
            updateStats();
            setupEventListeners();
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞–¥–∞—á
            checkAndRecordActivity();
        }

        // –°–±—Ä–æ—Å –≤—Å–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É)
        function resetAllActivity() {
            activityData = {};
            localStorage.removeItem('fitTrackerActivity');
            // saveActivityData(); // –ù–µ –Ω—É–∂–Ω–æ, –º—ã –∏ —Ç–∞–∫ —É–¥–∞–ª—è–µ–º –∏–∑ localStorage
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        function loadActivityData() {
            const saved = localStorage.getItem('fitTrackerActivity');
            if (saved) {
                try {
                    activityData = JSON.parse(saved);
                } catch (e) {
                    activityData = {};
                }
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        function saveActivityData() {
            localStorage.setItem('fitTrackerActivity', JSON.stringify(activityData));
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –±–ª–æ–∫–æ–≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
        function renderWorkoutBlocks() {
            const track = document.getElementById('workout-track');
            track.innerHTML = '';

            workoutProgram.forEach((workout, index) => {
                const block = document.createElement('div');
                block.className = 'workout-block';

                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å focused –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞
                if (index === selectedWorkout - 1) {
                    block.classList.add('focused');
                }

                // –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π –±–ª–æ–∫ —Ç–æ–ª—å–∫–æ —Å –Ω–æ–º–µ—Ä–æ–º –¥–Ω—è
                block.innerHTML = `
                    <div class="workout-number">${workout.day}</div>
                `;

                block.addEventListener('click', () => {
                    selectWorkout(workout.day);
                    openWorkoutModal(workout);
                });
                track.appendChild(block);
            });

            // –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ
            setTimeout(() => {
                const focusedBlock = track.querySelector('.workout-block.focused');
                if (focusedBlock) {
                    focusedBlock.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
                }
            }, 100);
        }

        // –í—ã–±–æ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function selectWorkout(day) {
            selectedWorkout = day;
            document.querySelectorAll('.workout-block').forEach((block, index) => {
                block.classList.toggle('focused', index === day - 1);
            });
        }

        // ===== –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ü–†–û–¶–ï–ù–¢–ù–û–ô –°–ò–°–¢–ï–ú–´ =====

        // –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–π –∑–∞–¥–∞—á–∏
        function getTaskCompletionPercentage(task) {
            if (task.subtasks && task.subtasks.length > 0) {
                const completedSubtasks = task.subtasks.filter(st => st.completed).length;
                return Math.round((completedSubtasks / task.subtasks.length) * 100);
            }
            return task.completed ? 100 : 0;
        }

        // –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –¥–Ω—è
        function calculateCompletionPercentage(day) {
            const tasks = todoData[day];
            if (!tasks || tasks.length === 0) return 0;

            let totalPercentage = 0;

            tasks.forEach(task => {
                const taskPercentage = getTaskCompletionPercentage(task);
                totalPercentage += taskPercentage;
                console.log(`–ó–∞–¥–∞—á–∞ "${task.text}": ${taskPercentage}%`);
            });

            const avgPercentage = Math.round(totalPercentage / tasks.length);
            console.log(`–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –¥–ª—è –¥–Ω—è ${day}: ${avgPercentage}%`);
            return avgPercentage;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∑–∞–¥–∞—á–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–¥–∑–∞–¥–∞—á
        function updateParentTaskCompletion(taskId) {
            // –ò—â–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –∑–∞–¥–∞—á—É, —Å–æ–¥–µ—Ä–∂–∞—â—É—é —ç—Ç—É –ø–æ–¥–∑–∞–¥–∞—á—É
            Object.keys(todoData).forEach(day => {
                if (todoData[day]) {
                    todoData[day].forEach(task => {
                        if (task.subtasks) {
                            const subtask = task.subtasks.find(st => st.id === taskId);
                            if (subtask) {
                                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∑–∞–¥–∞—á–∏
                                const percentage = getTaskCompletionPercentage(task);
                                const newCompletedState = percentage === 100;

                                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –¥–∞–Ω–Ω—ã—Ö
                                task.completed = newCompletedState;
                                console.log(`–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞ "${task.text}" ${newCompletedState ? '–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞' : '–¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞'} —á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–¥–∞—á–∏`);

                                // –û–±–Ω–æ–≤–ª—è–µ–º UI —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∑–∞–¥–∞—á–∏
                                const parentCheckbox = document.getElementById(task.id);
                                if (parentCheckbox) {
                                    parentCheckbox.checked = newCompletedState;
                                    const todoItem = parentCheckbox.closest('.todo-item');
                                    if (todoItem) {
                                        todoItem.classList.toggle('completed', newCompletedState);
                                    }
                                }
                            }
                        }
                    });
                }
            });
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            saveTodoStates();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –∑–∞–¥–∞—á –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö –ø–æ–¥–∑–∞–¥–∞—á
        function updateAllParentTasks() {
            Object.keys(todoData).forEach(day => {
                if (todoData[day]) {
                    todoData[day].forEach(task => {
                        if (task.subtasks && task.subtasks.length > 0) {
                            const percentage = getTaskCompletionPercentage(task);
                            const shouldBeCompleted = percentage === 100;

                            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–¥–∑–∞–¥–∞—á–∞–º
                            if (task.completed !== shouldBeCompleted) {
                                task.completed = shouldBeCompleted;
                                console.log(`–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞ "${task.text}" –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ ${shouldBeCompleted ? '–≤—ã–ø–æ–ª–Ω–µ–Ω–∞' : '–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞'}`);
                            }
                        }
                    });
                }
            });
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            saveTodoStates();
        }

        // ===== –ö–û–ù–ï–¶ –ù–û–í–´–• –§–£–ù–ö–¶–ò–ô =====

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function checkWorkoutCompleted(day) {
            const today = new Date();
            const currentDay = today.getDay() === 0 ? 7 : today.getDay(); // –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ = 7
            return day <= currentDay && getActivityForDate(new Date()) > 0;
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        function renderActivityGrid() {
            const container = document.getElementById('calendar-months');
            const yearElement = document.getElementById('current-year');
            const tooltip = document.getElementById('activity-tooltip');

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–æ–¥–∞
            yearElement.textContent = currentYear;

            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
            container.innerHTML = '';

            const today = new Date();
            const todayKey = formatDateKey(today);

            const monthNames = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                               '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];
            const weekDays = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –º–µ—Å—è—Ü—ã
            for (let month = 0; month < 12; month++) {
                const firstDay = new Date(currentYear, month, 1);
                const lastDay = new Date(currentYear, month + 1, 0);
                const numDays = lastDay.getDate();

                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –º–µ—Å—è—Ü–∞
                const monthDiv = document.createElement('div');
                monthDiv.className = 'calendar-month';

                // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –º–µ—Å—è—Ü–∞
                const monthHeader = document.createElement('div');
                monthHeader.className = 'calendar-month-header';
                monthHeader.textContent = monthNames[month];
                monthDiv.appendChild(monthHeader);

                // –°–æ–∑–¥–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
                const weekHeader = document.createElement('div');
                weekHeader.className = 'calendar-week';

                for (let i = 0; i < 7; i++) {
                    const dayLabel = document.createElement('div');
                    dayLabel.className = 'calendar-weekday';
                    dayLabel.textContent = weekDays[i];
                    weekHeader.appendChild(dayLabel);
                }
                monthDiv.appendChild(weekHeader);

                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è –º–µ—Å—è—Ü–∞
                let firstDayOfWeek = firstDay.getDay();
                firstDayOfWeek = firstDayOfWeek === 0 ? 6 : firstDayOfWeek - 1; // –ü–ù=0, –í–°–ö=6

                // –°–æ–∑–¥–∞–µ–º —è—á–µ–π–∫–∏ –¥–Ω–µ–π
                let currentDay = 1;
                let weekDiv;

                while (currentDay <= numDays) {
                    weekDiv = document.createElement('div');
                    weekDiv.className = 'calendar-week';

                    // –ó–∞–ø–æ–ª–Ω—è–µ–º –Ω–µ–¥–µ–ª—é
                    for (let dayOfWeek = 0; dayOfWeek < 7; dayOfWeek++) {
                        const cell = document.createElement('div');

                        if (currentDay === 1 && dayOfWeek < firstDayOfWeek) {
                            // –ü—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏ –¥–æ –Ω–∞—á–∞–ª–∞ –º–µ—Å—è—Ü–∞
                            cell.className = 'activity-cell empty';
                        } else if (currentDay <= numDays) {
                            // –Ø—á–µ–π–∫–∞ —Å –¥–Ω–µ–º
                            const currentDate = new Date(currentYear, month, currentDay);
                            const dateKey = formatDateKey(currentDate);
                            const activity = getActivityForDate(currentDate);

                            cell.className = 'activity-cell';
                            cell.dataset.date = dateKey;
                            cell.dataset.activity = activity;

                            if (dateKey === todayKey) {
                                cell.classList.add('today');
                            }

                            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–º–µ—Ä –¥–Ω—è
                            const dateNumber = document.createElement('span');
                            dateNumber.className = 'date-number';
                            dateNumber.textContent = currentDay;
                            cell.appendChild(dateNumber);

                            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                            cell.addEventListener('mouseenter', (e) => {
                                const options = { day: 'numeric', month: 'long', year: 'numeric' };
                                const dateString = currentDate.toLocaleDateString('ru-RU', options);
                                const activityText = activity > 0 ? `${activity} –º–∏–Ω—É—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏` : '–Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏';
                                tooltip.innerHTML = `
                                    <strong>${dateString}</strong><br>
                                    ${activityText}${dateKey === todayKey ? '<br><em>(–°–µ–≥–æ–¥–Ω—è)</em>' : ''}
                                `;
                                tooltip.classList.add('show');

                                const rect = e.target.getBoundingClientRect();
                                const containerRect = e.target.closest('.activity-grid-vertical').getBoundingClientRect();
                                tooltip.style.left = (rect.left - containerRect.left + rect.width / 2 - tooltip.offsetWidth / 2) + 'px';
                                tooltip.style.top = (rect.top - containerRect.top - tooltip.offsetHeight - 10) + 'px';
                            });

                            cell.addEventListener('mouseleave', () => {
                                tooltip.classList.remove('show');
                            });

                            // –£–¥–∞–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—Ä—É—á–Ω—É—é
                            // cell.addEventListener('click', () => {
                            //     recordActivity(currentDate);
                            // });

                            currentDay++;
                        } else {
                            // –ü—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏ –≤ –∫–æ–Ω—Ü–µ –º–µ—Å—è—Ü–∞
                            cell.className = 'activity-cell empty';
                        }

                        weekDiv.appendChild(cell);
                    }

                    monthDiv.appendChild(weekDiv);
                }

                container.appendChild(monthDiv);
            }
        }

        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–∞—Ç—ã
        function getActivityForDate(date) {
            const key = formatDateKey(date);
            return activityData[key] || 0;
        }

        // –§—É–Ω–∫—Ü–∏—è recordActivity —É–¥–∞–ª–µ–Ω–∞ - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–µ–ø–µ—Ä—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
        // –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤—Å–µ—Ö –∑–∞–¥–∞—á —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ checkAndRecordActivity()

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ –¥–∞—Ç—ã
        function formatDateKey(date) {
            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function formatDate(date) {
            return `${date.getDate()} ${['—è–Ω–≤', '—Ñ–µ–≤', '–º–∞—Ä', '–∞–ø—Ä', '–º–∞—è', '–∏—é–Ω', '–∏—é–ª', '–∞–≤–≥', '—Å–µ–Ω', '–æ–∫—Ç', '–Ω–æ—è', '–¥–µ–∫'][date.getMonth()]}`;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            let totalDays = 0;
            let totalWorkouts = 0;
            let currentStreak = 0;
            let longestStreak = 0;
            let tempStreak = 0;

            const today = new Date();
            const oneYearAgo = new Date(today.getTime() - 365 * 24 * 60 * 60 * 1000);

            for (let d = new Date(oneYearAgo); d <= today; d.setDate(d.getDate() + 1)) {
                const activity = getActivityForDate(d);
                if (activity > 0) {
                    totalDays++;
                    totalWorkouts++;
                    tempStreak++;
                    longestStreak = Math.max(longestStreak, tempStreak);
                } else {
                    tempStreak = 0;
                }
            }

            // –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–π —Å–µ—Ä–∏–∏
            tempStreak = 0;
            for (let d = new Date(today); d >= oneYearAgo; d.setDate(d.getDate() - 1)) {
                const activity = getActivityForDate(d);
                if (activity > 0) {
                    tempStreak++;
                } else {
                    break;
                }
            }
            currentStreak = tempStreak;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤
            document.getElementById('total-days').textContent = totalDays;
            document.getElementById('current-streak').textContent = currentStreak;
            document.getElementById('longest-streak').textContent = longestStreak;
            document.getElementById('total-workouts').textContent = totalWorkouts;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (–≤—Å–µ–≥–¥–∞ 0)
            // const completedCount = workoutProgram.filter(w => checkWorkoutCompleted(w.day)).length;
            // document.getElementById('completed-count').textContent = completedCount;
            document.getElementById('completed-count').textContent = '0';
        }

  
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function openWorkoutModal(workout) {
            const modal = document.getElementById('workout-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            modalTitle.textContent = `–î–µ–Ω—å ${workout.day}`;

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º todo-—Å–ø–∏—Å–æ–∫ –¥–ª—è —ç—Ç–æ–≥–æ –¥–Ω—è
            const dayTodos = todoData[workout.day];
            modalContent.innerHTML = createTodoHtml(dayTodos);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            modal.classList.add('show');
            document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ñ–æ–Ω–∞
        }

        function closeWorkoutModal() {
            const modal = document.getElementById('workout-modal');
            modal.classList.remove('show');
            document.body.style.overflow = ''; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
        }

        // –î–æ–±–∞–≤–∏–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤ setupEventListeners
        function setupModalListeners() {
            const modal = document.getElementById('workout-modal');
            const modalClose = document.getElementById('modal-close');

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ –∫—Ä–µ—Å—Ç–∏–∫
            modalClose.addEventListener('click', closeWorkoutModal);

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ –æ–≤–µ—Ä–ª–µ–π
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeWorkoutModal();
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∞–≤–∏—à–µ Escape
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modal.classList.contains('show')) {
                    closeWorkoutModal();
                }
            });
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≥–æ–¥–∞–º
            document.getElementById('prev-year').addEventListener('click', () => {
                currentYear--;
                renderActivityGrid();
                updateStats();
            });

            document.getElementById('next-year').addEventListener('click', () => {
                currentYear++;
                renderActivityGrid();
                updateStats();
            });

            // –°–±—Ä–æ—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            document.getElementById('reset-activity').addEventListener('click', () => {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
                    resetAllActivity();
                    renderActivityGrid();
                    updateStats();
                }
            });

            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft' && selectedWorkout > 1) {
                    selectWorkout(selectedWorkout - 1);
                } else if (e.key === 'ArrowRight' && selectedWorkout < 7) {
                    selectWorkout(selectedWorkout + 1);
                }
            });

            // –°–≤–∞–π–ø –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —Å –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ–º hover-—ç—Ñ—Ñ–µ–∫—Ç–æ–≤
            let touchStartX = 0;
            let isSwiping = false;
            const track = document.getElementById('workout-track');

            track.addEventListener('touchstart', (e) => {
                touchStartX = e.touches[0].clientX;
                isSwiping = false;
                const workoutBlocks = document.querySelectorAll('.workout-block');

                // –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º hover-—ç—Ñ—Ñ–µ–∫—Ç—ã
                workoutBlocks.forEach(block => {
                    block.style.transition = 'none';
                });
            }, { passive: true });

            track.addEventListener('touchmove', (e) => {
                isSwiping = true;
            }, { passive: true });

            track.addEventListener('touchend', (e) => {
                const touchEndX = e.changedTouches[0].clientX;
                const diff = touchStartX - touchEndX;

                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º hover-—ç—Ñ—Ñ–µ–∫—Ç—ã
                setTimeout(() => {
                    workoutBlocks.forEach(block => {
                        block.style.transition = '';
                    });
                }, 100);

                if (Math.abs(diff) > 50) { // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è —Å–≤–∞–π–ø–∞
                    if (diff > 0 && selectedWorkout < 7) {
                        selectWorkout(selectedWorkout + 1);
                    } else if (diff < 0 && selectedWorkout > 1) {
                        selectWorkout(selectedWorkout - 1);
                    }
                }
            });

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            setupModalListeners();
        }
    </script>
</body>

</html>